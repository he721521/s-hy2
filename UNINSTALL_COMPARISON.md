# S-Hy2 卸载方式对比

## 三种卸载方式详细对比

### 📊 对比表格

| 卸载方式 | 程序文件 | 配置文件 | 证书文件 | 用户账户 | 管理脚本 | 快捷命令 | 适用场景 |
|---------|---------|---------|---------|---------|---------|---------|---------|
| **方式1: 仅卸载服务器** | ✅ 删除 | ❌ 保留 | ❌ 保留 | ❌ 保留 | ❌ 保留 | ❌ 保留 | 临时卸载、升级、重装 |
| **方式2: 卸载服务器及配置** | ✅ 删除 | ✅ 删除 | ✅ 删除 | ✅ 删除 | ❌ 保留 | ❌ 保留 | 清理配置，保留脚本 |
| **方式3: 卸载所有内容** | ✅ 删除 | ✅ 删除 | ✅ 删除 | ✅ 删除 | ✅ 删除 | ✅ 删除 | 彻底清理、不再使用 |

## 🎯 选择建议

### 方式1: 仅卸载 Hysteria2 服务器
**推荐指数: ⭐⭐⭐⭐⭐**

**何时使用:**
- 🔄 临时卸载，计划重新安装
- 🆙 系统升级或重装前的准备
- 💾 保留配置以备后用
- 🧪 测试不同版本的 Hysteria2

**优点:**
- 保留所有配置，重新安装后可直接使用
- 保留证书文件，无需重新生成
- 保留管理脚本，操作便捷
- 卸载过程快速，风险最低

**操作:**
```bash
sudo s-hy2
# 选择 "9. 卸载服务" -> "1. 仅卸载 Hysteria2 服务器"
```

### 方式2: 卸载 Hysteria2 服务器及配置文件
**推荐指数: ⭐⭐⭐⭐**

**何时使用:**
- 🧹 清理所有配置，但保留管理脚本
- 🆕 重新开始全新配置
- 🧪 清理测试环境
- 🔒 出于安全考虑清理敏感配置

**优点:**
- 清理所有 Hysteria2 相关配置
- 保留管理脚本，便于重新部署
- 清理用户账户和证书
- 重新配置时从零开始

**操作:**
```bash
sudo s-hy2
# 选择 "9. 卸载服务" -> "2. 卸载 Hysteria2 服务器及配置文件"
```

### 方式3: 卸载脚本及 Hysteria2 服务器和所有文件
**推荐指数: ⭐⭐⭐**

**何时使用:**
- 🚫 不再使用 Hysteria2 和管理脚本
- 🧹 彻底清理系统
- 🔄 服务器用途完全改变
- 💾 释放所有相关存储空间

**优点:**
- 完全清理，不留任何痕迹
- 释放所有相关存储空间
- 适合服务器用途完全改变的情况

**缺点:**
- 重新使用需要重新安装脚本
- 操作不可逆，需要谨慎确认

**操作:**
```bash
sudo s-hy2
# 选择 "9. 卸载服务" -> "3. 卸载脚本及 Hysteria2 服务器和所有文件"
# 输入 "YES" 确认
```

## 🔄 重新安装指南

### 从方式1卸载后重新安装
```bash
# 直接重新安装 Hysteria2
sudo s-hy2
# 选择 "1. 安装 Hysteria2"
# 选择 "4. 管理服务" -> "1. 启动服务"
```

### 从方式2卸载后重新安装
```bash
# 重新安装和配置
sudo s-hy2
# 选择 "1. 安装 Hysteria2"
# 选择 "2. 一键快速配置"
```

### 从方式3卸载后重新安装
```bash
# 重新安装脚本
curl -fsSL https://raw.githubusercontent.com/sindricn/s-hy2/main/quick-install.sh | sudo bash

# 运行脚本并配置
sudo s-hy2
# 选择 "1. 安装 Hysteria2"
# 选择 "2. 一键快速配置"
```

## 🛡️ 安全注意事项

### 配置文件安全
- 配置文件包含认证密码和混淆密码
- 方式1保留配置文件，注意保护敏感信息
- 方式2和3会删除配置文件，确保数据安全

### 证书文件处理
- 自签名证书文件包含私钥信息
- ACME 证书会自动续期，卸载前考虑备份
- 方式1保留证书，方式2和3删除证书

### 端口跳跃规则
- 所有方式都会清理 iptables 规则
- 确保清理不会影响其他服务
- 如有自定义规则，请提前备份

## 📋 卸载验证清单

### 通用验证命令
```bash
# 检查 Hysteria2 程序
which hysteria

# 检查服务状态
sudo systemctl status hysteria-server

# 检查端口监听
sudo netstat -tulnp | grep :443
```

### 方式1验证 (应该存在)
```bash
# 检查配置文件
ls -la /etc/hysteria/

# 检查用户账户
id hysteria

# 检查管理脚本
which s-hy2
```

### 方式2验证 (应该存在)
```bash
# 检查管理脚本
which s-hy2

# 检查配置文件 (应该不存在)
ls -la /etc/hysteria/
```

### 方式3验证 (全部应该不存在)
```bash
# 检查管理脚本
which s-hy2

# 检查安装目录
ls -la /opt/s-hy2/

# 检查配置文件
ls -la /etc/hysteria/
```

## 🆘 故障恢复

### 误操作恢复
如果误选了错误的卸载方式：

1. **立即停止操作** - 如果还在确认阶段，选择取消
2. **检查剩余文件** - 使用验证命令检查还有哪些文件
3. **重新安装** - 根据剩余文件情况选择合适的重新安装方式

### 部分卸载失败
如果卸载过程中出现错误：

1. **查看错误信息** - 记录具体的错误提示
2. **手动清理** - 根据错误信息手动清理相关文件
3. **重新尝试** - 修复问题后重新尝试卸载

### 网络问题处理
如果因网络问题导致官方卸载脚本失败：

1. **检查网络连接** - 确保可以访问 get.hy2.sh
2. **手动删除文件** - 手动删除程序文件和服务文件
3. **清理残留** - 使用脚本的其他步骤清理残留文件

## 📞 技术支持

如果在卸载过程中遇到问题：

1. **查看日志** - 检查系统日志获取详细错误信息
2. **参考文档** - 查看 UNINSTALL_GUIDE.md 获取详细说明
3. **社区支持** - 在 GitHub 仓库提交 Issue

---

**仓库地址:** https://github.com/sindricn/s-hy2

**一键安装命令:**
```bash
curl -fsSL https://raw.githubusercontent.com/sindricn/s-hy2/main/quick-install.sh | sudo bash
```
