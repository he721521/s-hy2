# S-Hy2 功能特性详解

## 🚀 一键安装部署

### GitHub 一键安装
```bash
curl -fsSL https://raw.githubusercontent.com/sindricn/s-hy2/main/quick-install.sh | sudo bash
```

**特性：**
- 自动检测系统环境 (Ubuntu/Debian/CentOS/RHEL/Fedora)
- 自动安装必要依赖 (curl, wget, git, openssl, net-tools, iptables)
- 从 GitHub 下载最新版本脚本
- 创建快捷命令 `s-hy2` 和 `hy2-manager`
- 设置正确的文件权限
- 创建桌面快捷方式 (可选)

## 🎯 快捷命令

安装完成后，可以使用以下命令快速启动：

```bash
# 推荐使用 (简短易记)
sudo s-hy2

# 或者使用完整命令
sudo hy2-manager
```

## 📋 主菜单功能

### 1. 安装 Hysteria2
- 自动检测系统环境
- 预安装检查 (网络、端口、防火墙)
- 更新系统包和安装依赖
- 下载并安装 Hysteria2 官方程序
- 创建配置目录和设置权限

### 2. 一键快速配置 ⭐ (新功能)
**完全自动化配置，无需任何手动输入**

**自动执行步骤：**
1. **服务器信息获取**
   - 自动获取公网IP地址
   - 自动检测网络接口 (通过 `ip route` 和 `ip link`)

2. **智能伪装域名选择**
   - 测试 30+ 优质域名延迟
   - 自动选择延迟最低的域名
   - 包含 Cloudflare、Google、Microsoft、Apple 等知名服务

3. **安全密码生成**
   - 认证密码：16位随机强密码
   - 混淆密码：16位随机强密码
   - 使用 OpenSSL 生成，确保安全性

4. **自签名证书生成**
   - 使用 ECC P-256 算法
   - 10年有效期
   - 自动设置正确权限

5. **端口跳跃配置**
   - 默认范围：20000-50000
   - 目标端口：443
   - 自动生成 iptables 规则
   - 保存配置以便管理

6. **服务启动**
   - 自动启动 Hysteria2 服务
   - 设置开机自启
   - 验证服务状态

**配置结果：**
- 证书类型：自签名 (无需域名)
- 混淆：Salamander 算法
- 端口跳跃：已启用
- 伪装域名：自动选择最优
- 服务状态：运行中

### 3. 手动配置
传统的交互式配置方式，支持：

#### ACME 自动证书模式
- 域名验证和邮箱验证
- 自动申请 Let's Encrypt 证书
- 自动续期
- 适合生产环境

#### 自签名证书模式
- 自定义伪装域名
- 手动生成证书
- 快速部署
- 适合测试环境

### 4. 管理服务
**完整的服务生命周期管理**

#### 服务操作
- 启动/停止/重启服务
- 启用/禁用开机自启
- 详细的服务状态显示

#### 状态监控
- 实时服务状态
- 端口监听状态
- 进程信息 (PID、内存、CPU)
- 配置文件状态

#### 配置管理
- 查看配置文件
- 编辑配置文件 (nano)
- 备份和恢复配置
- 配置文件语法验证

### 5. 查看日志
- 实时日志查看 (`journalctl -f`)
- 历史日志查询 (50/100/500行，今天，自定义)
- 日志过滤和搜索

### 6. 测试伪装域名
**智能域名选择系统**

#### 预设域名测试
- 30+ 优质域名列表
- 并发延迟测试
- 按延迟排序显示结果

#### 交互式选择
- 显示测试结果排行榜
- 一键选择并更新配置
- 自动重启服务应用更改

#### 自定义域名测试
- 支持测试用户输入的域名
- 批量测试多个域名
- 显示详细测试结果

### 7. 进阶配置
**高级网络配置选项**

#### 端口修改
- 修改默认 443 端口
- 端口占用检测
- 防火墙配置提醒

#### 混淆配置
- 添加/移除 Salamander 混淆
- 自动生成混淆密码
- 客户端配置提醒

#### 端口跳跃
- 自动检测网络接口
- 自定义端口范围
- iptables 规则管理
- 规则持久化保存

### 8. 节点信息 ⭐ (新功能)
**完整的节点信息展示和管理**

#### 基本信息显示
- 服务器地址和端口
- 认证密码和混淆密码
- SNI域名和证书类型
- 端口跳跃配置

#### 节点链接生成
- 标准 Hysteria2:// 协议链接
- 包含所有必要参数
- 支持复制到剪贴板

#### 订阅链接生成
- Base64 编码的订阅链接
- 兼容主流客户端
- 支持批量导入

#### 客户端配置生成
- 完整的 YAML 配置文件
- 包含所有连接参数
- 可直接复制使用

#### 二维码生成
- 支持 qrencode 生成二维码
- 方便移动设备扫码导入
- 自动安装提示

#### 信息保存
- 保存到 `/etc/hysteria/node-info.txt`
- 包含所有连接信息
- 便于备份和分享

### 9. 卸载服务
**灵活的卸载选项**

#### 仅卸载程序 (推荐)
- 删除 Hysteria2 程序文件
- 保留配置文件和证书
- 保留用户账户
- 适合临时卸载或升级

#### 完全卸载
- 删除所有相关文件
- 清理用户账户
- 清理 systemd 服务
- 清理 iptables 规则
- 需要输入 "YES" 确认

### 10. 关于脚本
- 版本信息
- 功能特性介绍
- 使用说明

## 🔧 技术特性

### 自动化程度
- **一键快速配置**：零手动输入，3分钟完成部署
- **智能检测**：自动识别系统环境和网络配置
- **错误处理**：完善的错误检测和恢复机制

### 安全性
- **强密码生成**：使用 OpenSSL 生成随机密码
- **权限控制**：配置文件 600 权限，证书文件专用用户
- **混淆加密**：默认启用 Salamander 混淆
- **端口跳跃**：增强连接稳定性和安全性

### 兼容性
- **多系统支持**：Ubuntu/Debian/CentOS/RHEL/Fedora
- **版本兼容**：支持各主要版本
- **架构支持**：x86_64/ARM64 等主流架构

### 用户体验
- **彩色界面**：清晰的颜色标识和提示
- **详细反馈**：每步操作都有明确的状态反馈
- **错误提示**：友好的错误信息和解决建议
- **快捷命令**：简短易记的 `s-hy2` 命令

### 可维护性
- **模块化设计**：功能模块独立，易于维护
- **配置备份**：自动备份配置文件
- **日志记录**：详细的操作和错误日志
- **版本控制**：支持在线更新和回滚

## 🎯 使用场景

### 新手用户
- 使用 "一键快速配置" 功能
- 零技术门槛，3分钟完成部署
- 自动优化所有配置参数

### 高级用户
- 使用 "手动配置" 功能
- 自定义所有配置参数
- 使用进阶配置功能

### 生产环境
- 使用 ACME 自动证书
- 配置域名和邮箱
- 启用监控和日志

### 测试环境
- 使用自签名证书
- 快速部署和测试
- 方便重置和重新配置

## 📊 性能优化

### 域名选择优化
- 自动测试 30+ 优质域名
- 选择延迟最低的域名
- 减少连接建立时间

### 网络优化
- 端口跳跃提高稳定性
- 混淆加密绕过检测
- 自动检测最优网络接口

### 系统优化
- 合理的默认配置参数
- 自动设置文件权限
- 优化的服务启动配置

## 🔄 更新和维护

### 在线更新
- 支持从 GitHub 获取最新版本
- 保留用户配置和数据
- 自动备份重要文件

### 配置管理
- 自动配置备份机制
- 支持配置版本控制
- 快速恢复和回滚

### 监控告警
- 服务状态监控
- 日志异常检测
- 性能指标收集

这个 S-Hy2 脚本项目提供了从安装到配置、从管理到监控的完整解决方案，特别是新增的"一键快速配置"功能，让 Hysteria2 的部署变得前所未有的简单！
